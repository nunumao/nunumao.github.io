<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>编程日记</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/default.min.css">
  
<link rel="stylesheet" href="/css/github-markdown.css">

  
<link rel="stylesheet" href="/css/atom-one-dark.css">

  <script src="https://cdn.tailwindcss.com"></script>
  
<script src="/js/jquery.min.js"></script>

  
<script src="/js/script.js"></script>

<meta name="generator" content="Hexo 7.3.0"></head>

<body class="bg-gray-50 text-gray-800">
  <div class="lg:hidden fixed right-4 top-4 z-50">
    <button class="p-2 bg-white/80 backdrop-blur-sm rounded-lg border" data-mobile-menu-trigger><i class="fas fa-bars"></i></button>
  </div>
  <!-- 导航栏 -->
  <nav class="border-b bg-white/80 backdrop-blur-sm sticky top-0 z-40">
    <div class="max-w-5xl mx-auto px-4">
      <div class="flex justify-between items-center h-16">
        <a href="/" class="text-xl font-serif">编程日记</a>
        <!-- 桌面端导航 -->
        <div class="hidden lg:flex items-center space-x-6">
          <div class="flex items-center space-x-6 text-sm">
            <a href="/" class="hover:text-blue-600" data-i18n="nav.home">首页</a>
            <!-- 分类下拉菜单 -->
            <div class="relative group">
              <a href="/categories" class="hover:text-blue-600">分类</a>
              <!-- 优化后的下拉内容 -->
              <div class="absolute left-0 mt-2 py-2 bg-white backdrop-blur-sm border rounded-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50">
                <div class="grid grid-cols-2 gap-1 w-[400px] p-4">
                  
                    
                      
                        <a class="flex items-center space-x-2 p-2 rounded-lg hover:bg-blue-50" href="/categories/前端技术/">
                          <i class="fas fa-code text-blue-500"></i>
                          <span>前端技术</span>
                        </a>
                      
                    
                      
                        <a class="flex items-center space-x-2 p-2 rounded-lg hover:bg-blue-50" href="/categories/服务器/">
                          <i class="fas fa-code text-blue-500"></i>
                          <span>服务器</span>
                        </a>
                      
                    
                      
                    
                      
                        <a class="flex items-center space-x-2 p-2 rounded-lg hover:bg-blue-50" href="/categories/后端技术/">
                          <i class="fas fa-code text-blue-500"></i>
                          <span>后端技术</span>
                        </a>
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                  
                </div>
              </div>
            </div>
            <a href="/case" class="hover:text-blue-600" data-i18n="nav.case">作品</a>
            <a href="/archives" class="hover:text-blue-600" data-i18n="nav.archives">归档</a>
            <a href="/about" class="hover:text-blue-600" data-i18n="nav.about">关于</a>
            <!-- 搜索框 -->
            <div class="relative">
              <input type="search" placeholder="Search articles..." class="w-48 px-4 py-1 text-sm border rounded-full bg-gray-50 focus:outline-none focus:ring-1 focus:ring-blue-500">
              <i class="fas fa-search absolute right-3 top-2 text-gray-400"></i>
            </div>
            <!-- 语言切换 -->
            <div class="flex items-center space-x-2 ml-4 text-sm border-l pl-4">
              <button class="lang-switch hover:text-blue-600" @click="changeLang('en-US')">EN</button>
              <span class="text-gray-300">|</span>
              <button class="lang-switch hover:text-blue-600" @click="changeLang('zh-CN')">简</button>
              <span class="text-gray-300">|</span>
              <button class="lang-switch hover:text-blue-600" @click="changeLang('zh-TW')">繁</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </nav>
  <div id="mobileMenu" class="fixed inset-0 bg-white/90 backdrop-blur-sm z-40 lg:hidden hidden">
    <div class="h-full w-full flex flex-col items-center justify-center space-y-6 text-lg">
      <a href="/" class="hover:text-blue-600" data-i18n="nav.home">首页</a>
      <a href="/categories" class="hover:text-blue-600" data-i18n="nav.categories">分类</a>
      <a href="/case" class="hover:text-blue-600" data-i18n="nav.case">作品</a>
      <a href="/archives" class="hover:text-blue-600" data-i18n="nav.archive">归档</a>
      <a href="/about" class="hover:text-blue-600" data-i18n="nav.about">关于</a>
      <div class="flex items-center space-x-4 mt-4">
        <button class="lang-switch hover:text-blue-600" data-lang="en">EN</button>
        <button class="lang-switch hover:text-blue-600" data-lang="zh">简</button>
        <button class="lang-switch hover:text-blue-600" data-lang="zh-TW">繁</button>
      </div>
    </div>
  </div>
  <main class="max-w-5xl mx-auto px-4 py-12">
  <div class="lg:flex lg:gap-8">
    <!-- 文章主体 -->
    <article class="lg:w-3/4">
      <!-- 文章容器 -->
      <div class="bg-white rounded-xl overflow-hidden">
        <!-- 文章头部 -->
        <div class="px-8 pt-12 pb-8">
          <!-- 标题 -->
          <h1 class="text-3xl font-medium mb-6 leading-snug">
            机器学习 (三) | Sklearn管道
          </h1>

          <!-- 元信息 -->
          <div class="flex flex-wrap items-center gap-6 text-sm text-gray-500">
            <span>
              <i class="fas fa-folder-open mr-2"></i>
              
                <a href="/categories/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/PYTHON/" class="hover:text-blue-600">
                  PYTHON
                </a>
                
            </span>
            <span>
              <i class="far fa-calendar mr-2"></i>
              2025-02-04
            </span>
            <span><i class="far fa-clock mr-2"></i>15 分钟阅读</span>
            <span><i class="far fa-eye mr-2"></i>
              0
            </span>
          </div>
        </div>

        <!-- 文章内容 -->
        <div class="px-8 py-10 border-t border-b">
          <div class="markdown-body">
            <p><strong>管道 (Pipelines):  组装生产线</strong></p>
<p>想象一下你在工厂里组装一个玩具。 你不会把所有的零件都堆在一起然后一次性组装，而是会有一个流程：先装轮子，再装车身，最后装车顶。  在机器学习中，我们也可以把不同的数据处理和模型训练步骤串联起来，形成一个“管道 (Pipeline)”。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[ 原始数据 ] --&gt; [ 特征提取 ] --&gt; [ 特征缩放 ] --&gt; [ 模型训练 ] --&gt; [ 最终模型 ]</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>为什么需要管道？</strong><ul>
<li><strong>简化代码:</strong>  不用一步步地对数据进行处理，代码更简洁易懂。</li>
<li><strong>防止数据泄露:</strong>  在交叉验证（后面会讲到）等场景下，可以确保数据处理步骤只在训练集上进行，避免“泄露”测试集的信息。</li>
<li><strong>方便部署:</strong>  一个管道就是一个整体，方便保存和部署。</li>
</ul>
</li>
</ul>
<p><strong>交叉验证 (Cross-Validation):  多方会诊</strong></p>
<p>就像看病时，你可能不会只听一个医生的意见，而是会找几个医生会诊，以获得更可靠的诊断结果。 在机器学习中，为了更可靠地评估模型的性能，我们会使用“交叉验证 (Cross-Validation)”。</p>
<p>最常见的交叉验证方法是 <strong>K 折交叉验证 (K-Fold Cross-Validation)</strong>。</p>
<ol>
<li><p><strong>分割数据:</strong>  把训练数据分成 K 份（称为“折”）。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">[ 折 1 ] [ 折 2 ] [ 折 3 ] ... [ 折 K ]</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>循环训练和评估:</strong>  进行 K 次训练和评估。 每次选择其中一份作为“验证集”来评估模型，剩下的 K-1 份作为“训练集”来训练模型。</p>
<ul>
<li>第一次：[ 训练集：折 2 - 折 K ]  [ 验证集：折 1 ]</li>
<li>第二次：[ 训练集：折 1, 折 3 - 折 K ] [ 验证集：折 2 ]</li>
<li>…</li>
<li>第 K 次：[ 训练集：折 1 - 折 K-1 ] [ 验证集：折 K ]</li>
</ul>
</li>
<li><p><strong>计算平均性能:</strong>  计算 K 次评估结果的平均值，作为模型最终的性能指标。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">评估结果 1 + 评估结果 2 + ... + 评估结果 K</span><br><span class="line">-------------------------------------  = 平均性能</span><br><span class="line">                    K</span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li><strong>为什么需要交叉验证？</strong><ul>
<li><strong>更可靠的评估:</strong>  避免模型性能的评估结果只依赖于一次特定的数据划分，更客观地反映模型的泛化能力。</li>
<li><strong>更好地选择模型和超参数:</strong>  可以比较不同模型或不同超参数组合在交叉验证上的表现，选择最优的方案。</li>
</ul>
</li>
</ul>
<p><strong>模型选择与超参数调优：  精雕细琢</strong></p>
<p>我们前面提到了超参数，它们是模型训练前需要设置的参数。  找到合适的超参数组合，就像给雕塑作品进行最后的打磨，可以显著提升模型性能。</p>
<ul>
<li><p><strong>网格搜索 (Grid Search):</strong>  就像在一个表格里，把所有可能的超参数组合都尝试一遍。</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">超参数 A 的可能取值： A1, A2, A3</span><br><span class="line">超参数 B 的可能取值： B1, B2</span><br><span class="line"></span><br><span class="line">所有可能的组合：</span><br><span class="line">(A1, B1), (A1, B2)</span><br><span class="line">(A2, B1), (A2, B2)</span><br><span class="line">(A3, B1), (A3, B2)</span><br></pre></td></tr></table></figure>

<p> 对于每一种组合，我们都会训练一个模型，并使用交叉验证来评估其性能，最终选择性能最好的组合。</p>
</li>
<li><p><strong>随机搜索 (Randomized Search):</strong>  不是尝试所有可能的组合，而是在超参数的取值范围内随机选取若干组进行尝试。  当超参数的取值范围很大时，随机搜索通常比网格搜索更高效。</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">超参数 A 的取值范围： [最小值, 最大值]</span><br><span class="line">超参数 B 的取值范围： [最小值, 最大值]</span><br><span class="line"></span><br><span class="line">随机选择一些点进行尝试：</span><br><span class="line">(A_random1, B_random1), (A_random2, B_random2), ...</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>集成学习 (Ensemble Learning):  集思广益</strong></p>
<p>就像一个复杂的问题，多个人一起思考往往比一个人单独思考更容易找到好的解决方案。  “集成学习 (Ensemble Learning)” 的思想就是结合多个“弱学习器”的预测结果，得到一个更强大、更准确的“强学习器”。</p>
<ul>
<li><p><strong>装袋 (Bagging):</strong>  就像让几个不同的木匠各自独立地制作一把椅子，然后投票决定最终的椅子是什么样的。  它会从原始训练集中有放回地抽取多个子集，用每个子集训练一个独立的模型，最终的预测结果通过投票或平均得到。  <strong>随机森林 (Random Forest)</strong> 就是装袋的代表。</p>
</li>
<li><p><strong>提升 (Boosting):</strong>  就像老师辅导学生，会先让学生做一套题，然后重点讲解学生做错的题目，再让学生做一套类似的题，不断地迭代提升。  提升算法会 последовательно 地训练多个模型，每个模型都试图纠正前面模型的错误。  <strong>梯度提升机 (Gradient Boosting Machine, GBM)</strong> 就是提升的代表。</p>
</li>
<li><p><strong>堆叠 (Stacking):</strong>  就像一个委员会，由多个专家组成，每个专家先独立给出自己的意见，然后由一个“元学习器”综合这些意见，给出最终的结论。  它会训练多个不同的基模型，然后用另一个模型（元学习器）来学习如何组合这些基模型的预测结果。</p>
</li>
</ul>
<p><strong>模型持久化 (Model Persistence):  保存成果</strong></p>
<p>训练好的模型就像你辛辛苦苦做出来的一个工具，我们希望能够保存下来，以后可以重复使用，而不用每次都重新训练。  “模型持久化 (Model Persistence)” 就是将训练好的模型保存到硬盘上，以便将来加载和使用。  这就像把菜谱保存下来，下次想做这道菜的时候就可以直接拿出来看。</p>
<p><strong>无监督学习的更多应用：  发现隐藏的结构</strong></p>
<p>我们前面简单介绍了聚类，它是无监督学习的一种。  无监督学习的目标是从没有标签的数据中发现隐藏的模式和结构。 除了聚类，还有一些其他的无监督学习方法：</p>
<ul>
<li><p><strong>降维 (Dimensionality Reduction):</strong>  我们之前提到过 PCA，它可以减少数据的特征数量，同时保留最重要的信息。  降维可以帮助我们可视化高维数据，加快模型训练速度，并去除一些噪声特征。</p>
</li>
<li><p><strong>异常检测 (Anomaly Detection):</strong>  识别数据中不寻常的、与其他数据点显著不同的样本。  比如，检测信用卡欺诈、设备故障等。</p>
</li>
<li><p><strong>关联规则挖掘 (Association Rule Mining):</strong>  发现数据项之间的有趣关系。  比如，在超市的购物篮数据中发现“买了啤酒的人也经常买尿布”的规律。</p>
</li>
</ul>
<p><strong>总结</strong></p>
<p>我们现在了解了一些更高级的 Sklearn 概念，包括如何组织机器学习的流程（管道），如何更可靠地评估模型性能（交叉验证），如何优化模型参数（网格搜索和随机搜索），如何结合多个模型的力量（集成学习），以及如何保存和重复使用模型（模型持久化）。  此外，我们也回顾了无监督学习的一些重要应用。</p>
<p>这些概念是构建更强大、更可靠的机器学习模型的关键。  虽然我们没有涉及代码，但理解这些背后的思想，将为未来学习和应用 Sklearn 打下坚实的基础。  继续加油！</p>

          </div>
        </div>

        <!-- 文章底部 -->
        <div class="px-8 py-8">
          <!-- 标签 -->
          
            <div class="flex flex-wrap gap-2 mb-8">
              
                <a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-full text-sm text-gray-600 transition-colors">
                  机器学习
                </a>
                
            </div>
            

              <!-- 分享 -->
              <div class="flex items-center justify-between mb-8 py-6 border-t border-b">
                <div class="text-sm text-gray-500">分享文章：</div>
                <div class="flex gap-4">
                  <button class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="far fa-copy text-xl"></i>
                  </button>
                </div>
              </div>

              <!-- 上一篇/下一篇 -->
              <div class="flex flex-col sm:flex-row justify-between gap-4">
                
                  <a href="/cm72nkaxh001fwkwtc3j8hlsk.html" class="group flex-1">
                    <div class="text-sm text-gray-500 mb-1">上一篇</div>
                    <div class="group-hover:text-blue-600 transition-colors">
                      机器学习 (二) | 训练过程
                    </div>
                  </a>
                  
                    
                      <a href="/cm72nkaxi001lwkwt4b0q4v2l.html" class="group flex-1 text-right">
                        <div class="text-sm text-gray-500 mb-1">下一篇</div>
                        <div class="group-hover:text-blue-600 transition-colors">
                          机器学习 (四) | 常见问题的处理思路
                        </div>
                      </a>
                      
              </div>
        </div>
      </div>
    </article>

    <!-- 侧边栏 -->
    <aside class="lg:w-1/4 mt-8 lg:mt-0 space-y-6">
      <!-- 作者信息 -->
      <div class="bg-white rounded-xl p-6">
        <div class="flex items-center gap-4 mb-4">
          <img src="/images/avatar.jpg" class="w-16 h-16 rounded-full">
          <div>
            <h3 class="font-medium">Nunumao</h3>
            <p class="text-sm text-gray-500">开发工程师</p>
          </div>
        </div>
        <p class="text-sm text-gray-600 mb-4">专注于技术研究，热爱分享技术心得</p>
        <div class="flex justify-center gap-4">
          <a href="https://github.com/nunumao" target="_blank" class="text-gray-400 hover:text-gray-600">
            <i class="fab fa-github text-xl"></i>
          </a>
          <a href="mailto:gm292018748@email.com" target="_blank" class="text-gray-400 hover:text-[#1DA1F2]">
            <i class="fas fa-envelope text-xl"></i>
          </a>
        </div>
      </div>

      <!-- 目录 -->
      <div class="bg-white rounded-xl p-6 sticky top-24">
        <h2 class="text-lg font-medium mb-4">目录</h2>
        <nav class="space-y-2 text-sm">
          
        </nav>
      </div>

      <!-- 分类列表 -->
      <div class="bg-white rounded-xl p-6">
        <h2 class="text-lg font-medium mb-4">文章分类</h2>
        <div class="space-y-3">
          
            <a href="/categories/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF/" class="flex items-center justify-between group">
              <div class="flex items-center">
                <i class="fas fa-code text-blue-500 w-5"></i>
                <span class="text-sm group-hover:text-blue-600">
                  前端技术
                </span>
              </div>
              <span class="text-xs text-gray-500">
                1
              </span>
            </a>
            
            <a href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/" class="flex items-center justify-between group">
              <div class="flex items-center">
                <i class="fas fa-folder text-gray-500 w-5"></i>
                <span class="text-sm group-hover:text-blue-600">
                  服务器
                </span>
              </div>
              <span class="text-xs text-gray-500">
                3
              </span>
            </a>
            
            <a href="/categories/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/" class="flex items-center justify-between group">
              <div class="flex items-center">
                <i class="fas fa-server text-green-500 w-5"></i>
                <span class="text-sm group-hover:text-blue-600">
                  后端技术
                </span>
              </div>
              <span class="text-xs text-gray-500">
                31
              </span>
            </a>
            
        </div>
      </div>

      <!-- 相关文章 -->
      <div class="bg-white rounded-xl p-6">
        <h2 class="text-lg font-medium mb-4">相关文章</h2>
        <div class="space-y-4">
          
            <a href="/cm72nkaxe001awkwtc6bdgyhu.html" class="block group">
              <h3 class="text-sm font-medium group-hover:text-blue-600 line-clamp-2">
                Hello World
              </h3>
              <p class="text-xs text-gray-500 mt-1">2025-02-13</p>
            </a>
            
            <a href="/cm72nkax6000bwkwt554c1z0e.html" class="block group">
              <h3 class="text-sm font-medium group-hover:text-blue-600 line-clamp-2">
                Kotlin (一) | 基本语法
              </h3>
              <p class="text-xs text-gray-500 mt-1">2025-02-10</p>
            </a>
            
            <a href="/cm72nkax7000ewkwt2l4293ed.html" class="block group">
              <h3 class="text-sm font-medium group-hover:text-blue-600 line-clamp-2">
                Kotlin (三) | 函数
              </h3>
              <p class="text-xs text-gray-500 mt-1">2025-02-10</p>
            </a>
            
            <a href="/cm72nkax7000hwkwt7pw007e6.html" class="block group">
              <h3 class="text-sm font-medium group-hover:text-blue-600 line-clamp-2">
                Kotlin (七) | 集合
              </h3>
              <p class="text-xs text-gray-500 mt-1">2025-02-10</p>
            </a>
            
            <a href="/cm72nkax9000jwkwtccbg0esu.html" class="block group">
              <h3 class="text-sm font-medium group-hover:text-blue-600 line-clamp-2">
                Kotlin (二) | 控制流
              </h3>
              <p class="text-xs text-gray-500 mt-1">2025-02-10</p>
            </a>
            
        </div>
      </div>
    </aside>
  </div>
</main>

<style>
  .markdown-body {
    box-sizing: border-box;
    min-width: 200px;
    max-width: 100%;
    margin: 0 auto;
    background-color: white;
  }

  /* 适配深色模式 */
  @media (prefers-color-scheme: dark) {
    .markdown-body {
      color-scheme: dark;
      --color-prettylights-syntax-comment: #8b949e;
      --color-prettylights-syntax-constant: #79c0ff;
      --color-prettylights-syntax-entity: #d2a8ff;
      --color-prettylights-syntax-storage-modifier-import: #c9d1d9;
      --color-prettylights-syntax-entity-tag: #7ee787;
      --color-prettylights-syntax-keyword: #ff7b72;
      --color-prettylights-syntax-string: #a5d6ff;
      --color-prettylights-syntax-variable: #ffa657;
      --color-prettylights-syntax-brackethighlighter-unmatched: #f85149;
      --color-prettylights-syntax-invalid-illegal-text: #f0f6fc;
      --color-prettylights-syntax-invalid-illegal-bg: #8e1519;
      --color-prettylights-syntax-carriage-return-text: #f0f6fc;
      --color-prettylights-syntax-carriage-return-bg: #b62324;
      --color-prettylights-syntax-string-regexp: #7ee787;
      --color-prettylights-syntax-markup-list: #f2cc60;
      --color-prettylights-syntax-markup-heading: #1f6feb;
      --color-prettylights-syntax-markup-italic: #c9d1d9;
      --color-prettylights-syntax-markup-bold: #c9d1d9;
      --color-prettylights-syntax-markup-deleted-text: #ffdcd7;
      --color-prettylights-syntax-markup-deleted-bg: #67060c;
      --color-prettylights-syntax-markup-inserted-text: #aff5b4;
      --color-prettylights-syntax-markup-inserted-bg: #033a16;
      --color-prettylights-syntax-markup-changed-text: #ffdfb6;
      --color-prettylights-syntax-markup-changed-bg: #5a1e02;
      --color-prettylights-syntax-markup-ignored-text: #c9d1d9;
      --color-prettylights-syntax-markup-ignored-bg: #1158c7;
      --color-prettylights-syntax-meta-diff-range: #d2a8ff;
      --color-prettylights-syntax-brackethighlighter-angle: #8b949e;
      --color-prettylights-syntax-sublimelinter-gutter-mark: #484f58;
      --color-prettylights-syntax-constant-other-reference-link: #a5d6ff;
      --color-fg-default: #c9d1d9;
      --color-fg-muted: #8b949e;
      --color-fg-subtle: #6e7681;
      --color-canvas-default: #0d1117;
      --color-canvas-subtle: #161b22;
      --color-border-default: #30363d;
      --color-border-muted: #21262d;
      --color-neutral-muted: rgba(110, 118, 129, 0.4);
      --color-accent-fg: #58a6ff;
      --color-accent-emphasis: #1f6feb;
      --color-attention-subtle: rgba(187, 128, 9, 0.15);
      --color-danger-fg: #f85149;
    }
  }
</style>
  <!-- 页脚 -->
<footer class="border-t mt-16">
  <div class="max-w-4xl mx-auto px-4 py-8 text-center text-sm text-gray-500">
    <p>© 2025 nunumao. Built with <a href="#" class="text-blue-600">Hexo</a></p>
  </div>
</footer>
</body>

</html>